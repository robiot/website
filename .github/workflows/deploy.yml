name: "Deploy to production"

on:
  push:
    tags:
      - "v*"

jobs:
  deploy:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v2

        - name: Setup PNPM
          uses: pnpm/action-setup@v2.2.1

        - name: Setup Node
          uses: actions/setup-node@v3

          with:
            node-version: 16
            cache: 'pnpm'

        - name: Install dependencies
          run: pnpm install
        - name: Build
          run: pnpm run static
        - name: Edgeserver Upload
          uses: lvkdotsh/edgeserver-action@v0.0.34
          with:
            app_id: "105178663904874496"
            server: https://api.edgeserver.io
            token: ${{ secrets.EDGESERVER_TOKEN }}
            directory: out
